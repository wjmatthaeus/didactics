columns = continuous_vars,
aes(color = Sex, shape = Sex, , alpha = 0.7),
progress = FALSE
)
# Add theme
leplot_sex <- leplot_sex + theme_minimal() +
theme(
legend.position = "bottom",
strip.text = element_text(size = 10, face = "bold"),
panel.grid = element_blank()
) +
labs(
title = "Heart Health Continuous Variables",
subtitle = "Color = Sex, Shape = Sex"
)
leplot_sex
interaction(heart_data$Sex,heart_data$ExerciseInduced)
heart_data$SexByExercise <- factor(interaction(heart_data$Sex,heart_data$ExerciseInduced))
# Building the pair plot but how do I do second shape??
leplot_sex_ex <- ggpairs(
data = heart_data,
columns = continuous_vars,
aes(color = SexByExercise, shape = SexByExercise, , alpha = 0.7),
progress = FALSE
)
# Add theme
leplot_sex_ex <- leplot_sex_ex + theme_minimal() +
theme(
legend.position = "bottom",
strip.text = element_text(size = 10, face = "bold"),
panel.grid = element_blank()
) +
labs(
title = "Heart Health Continuous Variables",
subtitle = "Color = SexByExercise, Shape = SexByExercise"
)
leplot_sex_ex
# Building the pair plot but how do I do second shape??
leplot_sex_ex <- ggpairs(
data = heart_data,
columns = continuous_vars,
aes(color = SexByExercise, shape = SexByExercise, , alpha = 0.7),
progress = FALSE
)
# Add theme
leplot_sex_ex <- leplot_sex_ex + theme_minimal() +
theme(
legend.position = "bottom",
strip.text = element_text(size = 10, face = "bold"),
panel.grid = element_blank()
) +
labs(
title = "Heart Health Continuous Variables",
subtitle = "Color = SexByExercise, Shape = SexByExercise"
)+
scale_color_manual(values = c("lightblue","pink","blue","pink3"))
leplot_sex_ex
# Building the pair plot but how do I do second shape??
leplot_sex_ex <- ggpairs(
data = heart_data,
columns = continuous_vars,
aes(fill = SexByExercise, shape = SexByExercise, alpha = 0.7),
progress = FALSE
)
# Add theme
leplot_sex_ex <- leplot_sex_ex + theme_minimal() +
theme(
legend.position = "bottom",
strip.text = element_text(size = 10, face = "bold"),
panel.grid = element_blank()
) +
labs(
title = "Heart Health Continuous Variables",
subtitle = "Color = SexByExercise, Shape = SexByExercise"
)+
scale_fill_manual(values = c("lightblue","pink","blue","pink3"))
leplot_sex_ex
# Building the pair plot but how do I do second shape??
leplot_sex_ex <- ggpairs(
data = heart_data,
columns = continuous_vars,
aes(fill = SexByExercise, color= SexByExercise ,shape = SexByExercise, alpha = 0.7),
progress = FALSE
)
# Add theme
leplot_sex_ex <- leplot_sex_ex + theme_minimal() +
theme(
legend.position = "bottom",
strip.text = element_text(size = 10, face = "bold"),
panel.grid = element_blank()
) +
labs(
title = "Heart Health Continuous Variables",
subtitle = "Color = SexByExercise, Shape = SexByExercise"
)+
scale_fill_manual(values = c("lightblue","pink","blue","pink3"))
leplot_sex_ex
# Building the pair plot but how do I do second shape??
leplot_sex_ex <- ggpairs(
data = heart_data,
columns = continuous_vars,
aes(fill = SexByExercise, color= SexByExercise ,shape = SexByExercise, alpha = 0.7),
progress = FALSE
)
# Add theme
leplot_sex_ex <- leplot_sex_ex + theme_minimal() +
theme(
legend.position = "bottom",
strip.text = element_text(size = 10, face = "bold"),
panel.grid = element_blank()
) +
labs(
title = "Heart Health Continuous Variables",
subtitle = "Color = SexByExercise, Shape = SexByExercise"
)+
scale_fill_manual(values = c("lightblue","pink","blue","pink3"))+
scale_color_manual(values = c("lightblue","pink","blue","pink3"))
leplot_sex_ex
source("~/Dropbox/TCD Postdoc/A. Knetge/Data visualisation of binary variables in a pairplot/MLA1.r")
leplot_sex <- ggpairs(
data = heart_data,
columns = continuous_vars,
aes(fill = Sex, color= Sex ,shape = Sex, alpha = 0.7),
progress = FALSE
)
# Add theme
leplot_sex <- leplot_sex_ex + theme_minimal() +
theme(
legend.position = "bottom",
strip.text = element_text(size = 10, face = "bold"),
panel.grid = element_blank()
) +
labs(
title = "Heart Health Continuous Variables",
subtitle = "Color = Sex, Shape = Sex"
)+
scale_fill_manual(values = c("blue","pink3"))+
scale_color_manual(values = c("blue","pink3"))
leplot_sex <- ggpairs(
data = heart_data,
columns = continuous_vars,
aes(fill = Sex, color= Sex ,shape = Sex, alpha = 0.7),
progress = FALSE
)
# Add theme
leplot_sex <- leplot_sex + theme_minimal() +
theme(
legend.position = "bottom",
strip.text = element_text(size = 10, face = "bold"),
panel.grid = element_blank()
) +
labs(
title = "Heart Health Continuous Variables",
subtitle = "Color = Sex, Shape = Sex"
)+
scale_fill_manual(values = c("blue","pink3"))+
scale_color_manual(values = c("blue","pink3"))
leplot_sex
#this is to load in required packages
pkgs <- c("readr", "ggplot2", "dplyr", "readxl",
"tibble", "tidyr", "stringr",
"PerformanceAnalytics", "psych",
"FactoMineR", "factoextra","rstatix",
"nsprcomp","compositions","FactoInvestigate")
vapply(pkgs, library, logical(1), character.only = TRUE, logical.return = TRUE)
#change the working directory. update the string "/Users.." to contain the
#path to the directory containing this script and your data file
setwd("/Users/willmatthaeus/Dropbox/didactics/didactic_xrf/")
#only change this here, then the rest of the code should work for *your* data
# input_switch <-"Ant"
input_switch <- "Sid"
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#separate out the data columns and the error columns
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
}
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#separate out the data columns and the error columns
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
}
#only change this here, then the rest of the code should work for *your* data
# input_switch <-"Ant"
input_switch <- "Sid"
#read in data
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#separate out the data columns and the error columns
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
}
xrf
View(elements)
View(xrf)
#
xrf$SAMPLE %>% str_match("$(A-Z)*")%>%unique
xrf$SAMPLE
#
xrf$SAMPLE %>% str_match("\w+")%>%unique
#
xrf$SAMPLE %>% str_match("\\w+")%>%unique
#
xrf$SAMPLE %>% str_match("[A-Z]+")%>%unique
#
xrf %>% mutate(time = str_match(SAMPLE,"[A-Z]+"))
#
xrf2<-xrf %>% mutate(time = str_match(SAMPLE,"[A-Z]+"))
xrf2
View(xrf2)
#
xrf2<-xrf %>% mutate(time = str_match(SAMPLE,"[A-Z]+"))
str_split_fixed(xrf$SAMPLE,"_",n = 2)[2]
str_split_fixed(xrf$SAMPLE,"_",n = 2)[,2]
str_split_fixed(xrf$SAMPLE[2],"_",n = 2)[,2]
#
xrf2<-xrf %>% mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
View(xrf2)
xrf2$time
unique(xrf2$time)
#read in data
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#
xrf<-xrf %>% mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
#prototypes
# str_split_fixed(xrf$SAMPLE[2],"_",n = 2)[,2]
#separate out the data columns and the error columns
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
}
#adjust the 'shape' of the data from a matrix of elements to a table where
#each row is a single element concentration with a other categorical variables
#like taxon and locality
xrf_long <- xrf%>%
pivot_longer(cols = all_of(element_names),names_to = c("element"))%>%
rename(ppm=value)
xrf_long
View(xrf_long)
View(xrf_long)
element_names
xrf
View(xrf)
#
xrf<-xrf %>% select(c("SAMPLE", elements)) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
#
xrf<-xrf %>% select(all_of(c("SAMPLE", elements))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
c("SAMPLE", elements)
#
xrf<-xrf %>% select(all_of(c("SAMPLE", elements_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
#
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
#grab some more info from the sample names
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
#prototypes
# str_split_fixed(xrf$SAMPLE[2],"_",n = 2)[,2]
#separate out the data columns and the error columns
}
#adjust the 'shape' of the data from a matrix of elements to a table where
#each row is a single element concentration with a other categorical variables
#like taxon and locality
xrf_long <- xrf%>%
pivot_longer(cols = all_of(element_names),names_to = c("element"))%>%
rename(ppm=value)
View(xrf_long)
#grab some more info from the sample names
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)%>%
rename(time = "time[,1]")
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
#grab some more info from the sample names
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
#grab some more info from the sample names
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)%>%
rename(time = "time[,1]")
#prototypes
# str_split_fixed(xrf$SAMPLE[2],"_",n = 2)[,2]
#separate out the data columns and the error columns
}
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
#grab some more info from the sample names
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)%>%
rename(time = "time[, 1]")
#prototypes
# str_split_fixed(xrf$SAMPLE[2],"_",n = 2)[,2]
#separate out the data columns and the error columns
}
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
#grab some more info from the sample names
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
# %>%
#               rename(time = "time[, 1]")
#
#
# #prototypes
# xrf$t
# str_split_fixed(xrf$SAMPLE[2],"_",n = 2)[,2]
#separate out the data columns and the error columns
}
if(input_switch=="Sid"){
#read in the data
xrf <- read_excel(path = "data/Mastersheet.xlsx")
#find the group ids from the sample name and make a new column
xrf$group<-NA
xrf[grep("CSD",xrf$SAMPLE),]$group <- "new"
xrf[is.na(xrf$group),]$group <- "old"
xrf$group <- as.factor(xrf$group)
#
elements<-xrf[seq(2,76,2)]
element_names <- colnames(elements)
errors<-xrf[seq(3,77,2)]
error_names <- colnames(errors)
#grab some more info from the sample names
xrf<-xrf %>% select(all_of(c("SAMPLE", element_names))) %>%
mutate(splitted = str_split_fixed(SAMPLE,"_",n = 2),
site_time = splitted[,1],
time = str_match(splitted[,1],"[A-Z]+"),
species = splitted[,2],
)
# %>%
#               rename(time = "time[, 1]")
#
#
# #prototypes
# xrf$t
# str_split_fixed(xrf$SAMPLE[2],"_",n = 2)[,2]
#separate out the data columns and the error columns
}
#adjust the 'shape' of the data from a matrix of elements to a table where
#each row is a single element concentration with a other categorical variables
#like taxon and locality
xrf_long <- xrf%>%
pivot_longer(cols = all_of(element_names),names_to = c("element"))%>%
rename(ppm=value)
View(xrf_long)
View(xrf)
xrf_long$time
a_big_boxplot <- xrf_long %>%
ggplot()+#just to get things started
geom_boxplot(aes(x=species, y=ppm, color=element, fill = time))+#make boxplot shapes, separate in space using taxon, and color using locality
facet_wrap(element~., scales="free")+#separate element plots out into separate panels
theme(axis.text.x=element_text(angle=45, hjust = 1))
#some plot saving code
#useful for making nice plots with high res at a particular size
#i just played with the size til it looked good
#it saves into whatever directory you set at the the top
plotName<-"Sid_element_boxplots.png"
ggsave(plotName, plot = a_big_boxplot, device = "png", path = ".",
scale = 1, height = 16, width = 14, units = c("in"),
dpi = 300, limitsize = TRUE)
